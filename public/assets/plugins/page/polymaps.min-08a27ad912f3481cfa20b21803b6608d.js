if(!org)var org={};org.polymaps||(org.polymaps={}),function(t){function e(e){var n=e.indexOf(":");return 0>n?e:{space:t.ns[e.substring(0,n)],local:e.substring(n+1)}}function n(){for(var t=0;t<n.maps.length;t++)n.maps[t].resize()}function i(t){return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90}function r(t){return 180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360))}function a(t,e){if(t.row>e.row){var n=t;t=e,e=n}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function s(t,e,n,i,r){if(n=Math.max(n,Math.floor(e.y0)),i=Math.min(i,Math.ceil(e.y1)),t.x0==e.x0&&t.y0==e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var a=t;t=e,e=a}a=t.dx/t.dy;var s=e.dx/e.dy,o=t.dx>0,l=e.dx<0;for(n=n;i>n;n++){var u=a*Math.max(0,Math.min(t.dy,n+o-t.y0))+t.x0;r(Math.floor(s*Math.max(0,Math.min(e.dy,n+l-e.y0))+e.x0),Math.ceil(u),n)}}function o(t,e,n,i,r,o){var l=a(t,e);e=a(e,n),t=a(n,t),l.dy>e.dy&&(n=l,l=e,e=n),l.dy>t.dy&&(n=l,l=t,t=n),e.dy>t.dy&&(n=e,e=t,t=n),l.dy&&s(t,l,i,r,o),e.dy&&s(t,e,i,r,o)}t.version="2.5.1";var l={x:0,y:0};t.ns={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},t.id=function(){var t=0;return function(){return++t}}(),t.svg=function(e){return document.createElementNS(t.ns.svg,e)},t.transform=function(t,e,n,i,r,a){var s,o,l,u={};return arguments.length||(t=1,e=r=n=0,i=1,a=0),u.zoomFraction=function(r){return arguments.length?(o=r,s=Math.floor(o+Math.log(Math.sqrt(t*t+e*e+n*n+i*i))/Math.LN2),l=Math.pow(2,-s),u):o},u.apply=function(o){var l=Math.pow(2,-o.zoom),u=Math.pow(2,o.zoom-s);return{column:(t*o.column*l+n*o.row*l+r)*u,row:(e*o.column*l+i*o.row*l+a)*u,zoom:o.zoom-s}},u.unapply=function(o){var l=Math.pow(2,-o.zoom),u=Math.pow(2,o.zoom+s);return{column:(o.column*l*i-o.row*l*n-r*i+a*n)/(t*i-e*n)*u,row:(o.column*l*e-o.row*l*t-r*e+a*t)/(n*e-i*t)*u,zoom:o.zoom+s}},u.toString=function(){return"matrix("+[t*l,e*l,n*l,i*l].join(" ")+" 0 0)"},u.zoomFraction(0)},t.cache=function(t,e){function n(t){h--,e&&e(t),delete s[t.key],t.next?t.next.prev=t.prev:(l=t.prev)&&(l.next=null),t.prev?t.prev.next=t.next:(o=t.next)&&(o.prev=null)}function i(){for(var t=l;h>u&&t;t=t.prev)t.lock||n(t)}var r={},a={},s={},o=null,l=null,u=64,h=0;return r.peek=function(t){return s[[t.zoom,t.column,t.row].join("/")]},r.load=function(e,n){var i=[e.zoom,e.column,e.row].join("/"),r=s[i];return r?(r.prev&&((r.prev.next=r.next)?r.next.prev=r.prev:l=r.prev,r.prev=null,r.next=o,o=o.prev=r),r.lock=1,a[i]=r):(r={key:i,column:e.column,row:e.row,zoom:e.zoom,next:o,prev:null,lock:1},t.call(null,r,n),a[i]=s[i]=r,o?o.prev=r:l=r,o=r,h++,r)},r.unload=function(t){if(!(t in a))return!1;var e=a[t];return e.lock=0,delete a[t],e.request&&e.request.abort(!1)&&n(e),e},r.locks=function(){return a},r.size=function(t){return arguments.length?(u=t,i(),r):u},r.flush=function(){return i(),r},r.clear=function(){for(var t in s){var n=s[t];n.request&&n.request.abort(!1),e&&e(s[t]),n.lock&&(n.lock=0,n.element.parentNode.removeChild(n.element))}return a={},s={},o=l=null,h=0,r},r},t.url=function(e){function n(n){var a=n.zoom<0?1:1<<n.zoom,s=n.column;if(r)s=n.column%a,0>s&&(s+=a);else if(0>s||s>=a)return null;return e.replace(/{(.)}/g,function(e,r){switch(r){case"S":return i[(Math.abs(n.zoom)+n.row+s)%i.length];case"Z":return n.zoom;case"X":return s;case"Y":return n.row;case"B":var a=t.map.coordinateLocation({row:n.row,column:s,zoom:n.zoom}),o=t.map.coordinateLocation({row:n.row+1,column:s+1,zoom:n.zoom}),l=Math.ceil(Math.log(n.zoom)/Math.LN2);return o.lat.toFixed(l)+","+a.lon.toFixed(l)+","+a.lat.toFixed(l)+","+o.lon.toFixed(l)}return r})}var i=[],r=!0;return n.template=function(t){return arguments.length?(e=t,n):e},n.hosts=function(t){return arguments.length?(i=t,n):i},n.repeat=function(t){return arguments.length?(r=t,n):r},n},t.dispatch=function(t){var e={};return t.on=function(n,i){for(var r=e[n]||(e[n]=[]),a=0;a<r.length;a++)if(r[a].handler==i)return t;return r.push({handler:i,on:!0}),t},t.off=function(n,i){var r=e[n];if(r)for(var a=0;a<r.length;a++){var s=r[a];if(s.handler==i){s.on=!1,r.splice(a,1);break}}return t},function(n){var i=e[n.type];if(i){i=i.slice();for(var r=0;r<i.length;r++){var a=i[r];a.on&&a.handler.call(t,n)}}}},t.queue=function(){function e(){a>=s||!r.length||(a++,r.pop()())}function n(t){for(var e=0;e<r.length;e++)if(r[e]==t)return r.splice(e,1),!0;return!1}function i(t,i,s){function o(){l=new XMLHttpRequest,s&&l.overrideMimeType&&l.overrideMimeType(s),l.open("GET",t,!0),l.onreadystatechange=function(){4==l.readyState&&(a--,l.status<300&&i(l),e())},l.send(null)}var l;return r.push(o),e(),{abort:function(t){return n(o)?!0:t&&l?(l.abort(),!0):!1}}}var r=[],a=0,s=6;return{text:function(t,e,n){return i(t,function(t){t.responseText&&e(t.responseText)},n)},xml:function(t,e){return i(t,function(t){t.responseXML&&e(t.responseXML)},"application/xml")},json:function(t,e){return i(t,function(t){t.responseText&&e(JSON.parse(t.responseText))},"application/json")},image:function(i,s,o){function l(){u=document.createElement("img"),u.onerror=function(){a--,e()},u.onload=function(){a--,o(u),e()},u.src=s,i.setAttributeNS(t.ns.xlink,"href",s)}var u;return r.push(l),e(),{abort:function(t){return n(l)?!0:t&&u?(u.src="about:",!0):!1}}}}}(),t.map=function(){function e(){y&&(g<y[0]?g=y[0]:g>y[1]&&(g=y[1])),m=g-(g=Math.round(g)),v=Math.pow(2,m)}function a(){if(D){var t=45/Math.pow(2,g+m-3),e=Math.max(Math.abs(_*d.x+x*d.y),Math.abs(k*d.x+C*d.y)),n=i(S-e*t/f.y);e=i(T+e*t/f.y),p.lat=Math.max(n,Math.min(e,p.lat)),n=Math.max(Math.abs(_*d.y+x*d.x),Math.abs(k*d.y+C*d.x)),p.lon=Math.max(D[0].lon-n*t/f.x,Math.min(D[1].lon+n*t/f.x,p.lon))}}var s,o,h={},c=l,d=l,f={x:256,y:256},p={lat:37.76487,lon:-122.41948},g=12,m=0,v=1,y=[1,18],w=0,x=1,_=0,C=1,k=0,S=-180,T=180,D=[{lat:i(S),lon:-1/0},{lat:i(T),lon:1/0}];h.locationCoordinate=function(e){e=t.map.locationCoordinate(e);var n=Math.pow(2,g);return e.column*=n,e.row*=n,e.zoom+=g,e},h.coordinateLocation=t.map.coordinateLocation,h.coordinatePoint=function(t,e){var n=Math.pow(2,g-e.zoom),i=Math.pow(2,g-t.zoom),r=(e.column*n-t.column*i)*f.x*v;return n=(e.row*n-t.row*i)*f.y*v,{x:d.x+x*r-_*n,y:d.y+_*r+x*n}},h.pointCoordinate=function(t,e){var n=Math.pow(2,g-t.zoom),i=(e.x-d.x)/v,r=(e.y-d.y)/v;return{column:t.column*n+(C*i-k*r)/f.x,row:t.row*n+(k*i+C*r)/f.y,zoom:g}},h.locationPoint=function(t){var e=Math.pow(2,g+m-3)/45,n=(t.lon-p.lon)*e*f.x;return t=(r(p.lat)-r(t.lat))*e*f.y,{x:d.x+x*n-_*t,y:d.y+_*n+x*t}},h.pointLocation=function(t){var e=45/Math.pow(2,g+m-3),n=(t.x-d.x)*e;return t=(t.y-d.y)*e,{lon:p.lon+(C*n-k*t)/f.x,lat:i(r(p.lat)-(k*n+C*t)/f.y)}};var M=t.svg("rect");return M.setAttribute("visibility","hidden"),M.setAttribute("pointer-events","all"),h.container=function(t){return arguments.length?(s=t,s.setAttribute("class","map"),s.appendChild(M),h.resize()):s},h.focusableParent=function(){for(var t=s;t;t=t.parentNode)if(t.tabIndex>=0)return t;return window},h.mouse=function(e){var n=(s.ownerSVGElement||s).createSVGPoint();if(0>u&&(window.scrollX||window.scrollY)){var i=document.body.appendChild(t.svg("svg"));i.style.position="absolute",i.style.top=i.style.left="0px";var r=i.getScreenCTM();u=!(r.f||r.e),document.body.removeChild(i)}return u?(n.x=e.pageX,n.y=e.pageY):(n.x=e.clientX,n.y=e.clientY),n.matrixTransform(s.getScreenCTM().inverse())},h.size=function(t){return arguments.length?(o=t,h.resize()):c},h.resize=function(){return o?(c=o,n.remove(h)):(M.setAttribute("width","100%"),M.setAttribute("height","100%"),b=M.getBBox(),c={x:b.width,y:b.height},n.add(h)),M.setAttribute("width",c.x),M.setAttribute("height",c.y),d={x:c.x/2,y:c.y/2},a(),h.dispatch({type:"resize"}),h},h.tileSize=function(t){return arguments.length?(f=t,h.dispatch({type:"move"}),h):f},h.center=function(t){return arguments.length?(p=t,a(),h.dispatch({type:"move"}),h):p},h.panBy=function(t){var e=45/Math.pow(2,g+m-3),n=t.x*e;return t=t.y*e,h.center({lon:p.lon+(k*t-C*n)/f.x,lat:i(r(p.lat)+(k*n+C*t)/f.y)})},h.centerRange=function(t){return arguments.length?((D=t)?(S=D[0].lat>-90?r(D[0].lat):-1/0,T=D[0].lat<90?r(D[1].lat):1/0):(S=-1/0,T=1/0),a(),h.dispatch({type:"move"}),h):D},h.zoom=function(t){return arguments.length?(g=t,e(),h.center(p)):g+m},h.zoomBy=function(t,n,i){if(arguments.length<2)return h.zoom(g+m+t);arguments.length<3&&(i=h.pointLocation(n)),g=g+m+t,e();var r=h.locationPoint(i);return h.panBy({x:n.x-r.x,y:n.y-r.y})},h.zoomRange=function(t){return arguments.length?(y=t,h.zoom(g+m)):y},h.extent=function(t){if(!arguments.length)return[h.pointLocation({x:0,y:c.y}),h.pointLocation({x:c.x,y:0})];var n=h.locationPoint(t[0]),i=h.locationPoint(t[1]),r=Math.max((i.x-n.x)/c.x,(n.y-i.y)/c.y);return n=h.pointLocation({x:(n.x+i.x)/2,y:(n.y+i.y)/2}),g=g+m-Math.log(r)/Math.LN2,e(),h.center(n)},h.angle=function(t){return arguments.length?(w=t,x=Math.cos(w),_=Math.sin(w),C=Math.cos(-w),k=Math.sin(-w),a(),h.dispatch({type:"move"}),h):w},h.add=function(t){return t.map(h),h},h.remove=function(t){return t.map(null),h},h.dispatch=t.dispatch(h),h},n.maps=[],n.add=function(t){for(var e=0;e<n.maps.length;e++)if(n.maps[e]==t)return;n.maps.push(t)},n.remove=function(t){for(var e=0;e<n.maps.length;e++)if(n.maps[e]==t)return n.maps.splice(e,1),void 0},window.addEventListener&&(window.addEventListener("resize",n,!1),window.addEventListener("load",n,!1)),t.map.locationCoordinate=function(t){var e=1/360;return{column:(t.lon+180)*e,row:(180-r(t.lat))*e,zoom:0}},t.map.coordinateLocation=function(t){var e=45/Math.pow(2,t.zoom-3);return{lon:e*t.column-180,lat:i(180-e*t.row)}};var u=/WebKit/.test(navigator.userAgent)?-1:0;t.layer=function(e,n){function i(t){for(var e=b[0].nextSibling;t>d;d++){v.insertBefore(b[-4],e),v.insertBefore(b[2],e),v.insertBefore(b[1],e);for(var n=b[-4],i=-4;2>i;)b[i]=b[++i];b[i]=n}}function r(t){for(var e=b[0].nextSibling;d>t;d--){v.insertBefore(b[-1],e),v.insertBefore(b[2],b[-4]);for(var n=b[2],i=2;i>-4;)b[i]=b[--i];b[i]=n}}function a(){function e(e){var n=e.zoom,i=0>n?1:1<<n,r=e.column%i,a=e.row;return 0>r&&(r+=i),{locationPoint:function(e){e=t.map.locationCoordinate(e);var i=Math.pow(2,n-e.zoom);return{x:x.x*(i*e.column-r),y:x.y*(i*e.row-a)}}}}function n(t,n,i){var r=S.zoom,a=2-T,s=4+T;for(t=t;n>t;t++){var o=p.load({column:t,row:i,zoom:r},e);if(!(o.ready||o.key in D)){o.proxyRefs={};for(var l,u,h,c=1;a>=c;c++){u=!0;for(var d=0,f=1<<c;f>=d;d++)for(var g=0;f>=g;g++)(h=p.peek(l={column:(t<<c)+g,row:(i<<c)+d,zoom:r+c}))&&h.ready?(D[h.key]=p.load(l),h.proxyCount++,o.proxyRefs[h.key]=h):u=!1;if(u)break}if(!u)for(c=1;s>=c;c++)if((h=p.peek(l={column:t>>c,row:i>>c,zoom:r-c}))&&h.ready){D[h.key]=p.load(l),h.proxyCount++,o.proxyRefs[h.key]=h;break}}D[o.key]=o}}var a=f.map(),u=a.zoom(),h=u-(u=Math.round(u)),y=a.size(),w=a.angle(),x=a.tileSize(),_=a.locationCoordinate(a.center());if(d!=u){u>d?i(u):d>u?r(u):d=u;for(var C=-4;2>=C;C++){var k=b[C];k.setAttribute("class","zoom"+(0>C?"":"+")+C+" zoom"+(u+C)),k.setAttribute("transform","scale("+Math.pow(2,-C)+")")}}v.setAttribute("transform","translate("+y.x/2+","+y.y/2+")"+(w?"rotate("+w/Math.PI*180+")":"")+(h?"scale("+Math.pow(2,h)+")":"")+(c?c.zoomFraction(h):""));var S=a.pointCoordinate(_,l);C=a.pointCoordinate(_,{x:y.x,y:0}),u=a.pointCoordinate(_,y),a=a.pointCoordinate(_,{x:0,y:y.y}),h||w||c||(_.column=(Math.round(x.x*_.column)+(1&y.x)/2)/x.x,_.row=(Math.round(x.y*_.row)+(1&y.y)/2)/x.y),c&&(S=c.unapply(S),C=c.unapply(C),u=c.unapply(u),a=c.unapply(a),_=c.unapply(_));var T=s?s(S.zoom)-S.zoom:0;T&&(y=Math.pow(2,T),S.column*=y,S.row*=y,C.column*=y,C.row*=y,u.column*=y,u.row*=y,a.column*=y,a.row*=y,S.zoom=C.zoom=u.zoom=a.zoom+=T),h=p.locks();var D={};for(var M in h)h[M].proxyCount=0;m&&T>-5&&3>T&&(w=S.zoom<0?1:1<<S.zoom,g?(o(S,C,u,0,w,n),o(u,a,S,0,w,n)):(y=Math.floor((S.column+u.column)/2),w=Math.max(0,Math.min(w-1,Math.floor((C.row+a.row)/2))),C=Math.min(4,S.zoom),y=y>>C<<C,w=w>>C<<C,n(y,y+1,w)));for(M in D)C=D[M],y=Math.pow(2,C.level=C.zoom-_.zoom),C.element.setAttribute("transform","translate("+(C.x=x.x*(C.column-_.column*y))+","+(C.y=x.y*(C.row-_.row*y))+")");for(M in h)M in D||(C=p.unload(M),C.element.parentNode.removeChild(C.element),delete C.proxyRefs);for(M in D)C=D[M],C.element.parentNode!=b[C.level]&&(b[C.level].appendChild(C.element),f.show&&f.show(C));p.flush(),f.dispatch({type:"move"})}var s,u,h,c,d,f={},p=f.cache=t.cache(e,n).size(512),g=!0,m=!0,v=t.svg("g"),b={};v.setAttribute("class","layer");for(var y=-4;-1>=y;y++)b[y]=v.appendChild(t.svg("g"));for(y=2;y>=1;y--)b[y]=v.appendChild(t.svg("g"));return b[0]=v.appendChild(t.svg("g")),f.map=function(t){if(!arguments.length)return h;if(h){if(h==t)return v.parentNode.appendChild(v),f;h.off("move",a).off("resize",a),v.parentNode.removeChild(v)}return(h=t)&&(h.container().appendChild(v),f.init&&f.init(v),h.on("move",a).on("resize",a),a()),f},f.container=function(){return v},f.levels=function(){return b},f.id=function(t){return arguments.length?(u=t,v.setAttribute("id",t),f):u},f.visible=function(t){return arguments.length?((m=t)?v.removeAttribute("visibility"):v.setAttribute("visibility","hidden"),h&&a(),f):m},f.transform=function(t){return arguments.length?(c=t,h&&a(),f):c},f.zoom=function(t){return arguments.length?(s="function"==typeof t||null==t?t:function(){return t},h&&a(),f):s},f.tile=function(t){return arguments.length?(g=t,h&&a(),f):g},f.reload=function(){return p.clear(),h&&a(),f},f.dispatch=t.dispatch(f),f.on("load",function(t){if(t.tile.proxyRefs){for(var e in t.tile.proxyRefs){var n=t.tile.proxyRefs[e];--n.proxyCount<=0&&p.unload(e)&&n.element.parentNode.removeChild(n.element)}delete t.tile.proxyRefs}}),f},t.image=function(){var e,n=t.layer(function(i){var r=i.element=t.svg("image"),a=n.map().tileSize();r.setAttribute("preserveAspectRatio","none"),r.setAttribute("width",a.x),r.setAttribute("height",a.y),"function"==typeof e?(r.setAttribute("opacity",0),a=e(i),null!=a?i.request=t.queue.image(r,a,function(t){delete i.request,i.ready=!0,i.img=t,r.removeAttribute("opacity"),n.dispatch({type:"load",tile:i})}):(i.ready=!0,n.dispatch({type:"load",tile:i}))):(i.ready=!0,null!=e&&r.setAttributeNS(t.ns.xlink,"href",e),n.dispatch({type:"load",tile:i}))},function(t){t.request&&t.request.abort(!0)});return n.url=function(i){return arguments.length?(e="string"==typeof i&&/{.}/.test(i)?t.url(i):i,n.reload()):e},n},t.geoJson=function(e){function n(t){var e={lat:0,lon:0};return function(n){e.lat=n[1],e.lon=n[0];var i=t(e);return n.x=i.x,n.y=i.y,i}}function i(t,e){return t&&t.type in v&&v[t.type](t,e)}function r(t,e,n){return t.type in b&&b[t.type](t,e,n)}function a(){var t,e,n,i,a,s,o,u=l.map().zoom(),h=l.cache.locks();if("fixed"==m){for(t in h)if((e=h[t]).scale!=u){for(o="scale("+Math.pow(2,e.zoom-u)+")",i=-1,a=(n=e.features).length;++i<a;)r((s=n[i]).data.geometry,s.element,o);e.scale=u}}else for(t in h){for(i=-1,a=(n=(e=h[t]).features).length;++i<a;)r((s=n[i]).data.geometry,s.element,"");delete e.scale}}var s,o,l=t.layer(function(r,a){function u(t){var n=[];switch(t.next&&(r.request=e(t.next.href,u)),t.type){case"FeatureCollection":for(var s=0;s<t.features.length;s++){var o=t.features[s],c=i(o.geometry,a);c&&n.push({element:h.appendChild(c),data:o})}break;case"Feature":(c=i(t.geometry,a))&&n.push({element:h.appendChild(c),data:t});break;default:(c=i(t,a))&&n.push({element:h.appendChild(c),data:{type:"Feature",geometry:t}})}r.ready=!0,n.push.apply(r.features,n),l.dispatch({type:"load",tile:r,features:n})}var h=r.element=t.svg("g");r.features=[],a=n(a(r).locationPoint),null!=s?r.request=e("function"==typeof s?s(r):s,u):u({type:"FeatureCollection",features:o||[]})},function(t){t.request&&t.request.abort(!0)}),u=l.container(),h=!0,c="org.polymaps."+t.id(),d="url(#"+c+")",f=u.insertBefore(t.svg("clipPath"),u.firstChild),g=f.appendChild(t.svg("rect")),m="auto";u.setAttribute("fill-rule","evenodd"),f.setAttribute("id",c),arguments.length||(e=t.queue.json);var v={Point:function(e,n){var i=n(e.coordinates),r=t.svg("circle");return r.setAttribute("r",4.5),r.setAttribute("transform","translate("+i.x+","+i.y+")"),r},MultiPoint:function(e,n){for(var i,r,a=t.svg("g"),s=e.coordinates,o=-1,l=s.length;++o<l;)r=a.appendChild(t.svg("circle")),r.setAttribute("r",4.5),r.setAttribute("transform","translate("+(i=n(s[o])).x+","+i.y+")");return a},LineString:function(e,n){for(var i,r=t.svg("path"),a=["M"],s=e.coordinates,o=-1,l=s.length;++o<l;)a.push((i=n(s[o])).x,",",i.y,"L");return a.pop(),a.length?(r.setAttribute("d",a.join("")),r):void 0},MultiLineString:function(e,n){for(var i,r,a,s=t.svg("path"),o=[],l=e.coordinates,u=-1,h=l.length;++u<h;){for(i=l[u],r=-1,a=i.length,o.push("M");++r<a;)o.push((p=n(i[r])).x,",",p.y,"L");o.pop()}return o.length?(s.setAttribute("d",o.join("")),s):void 0},Polygon:function(e,n){for(var i,r,a,s=t.svg("path"),o=[],l=e.coordinates,u=-1,h=l.length;++u<h;){for(i=l[u],r=-1,a=i.length-1,o.push("M");++r<a;)o.push((p=n(i[r])).x,",",p.y,"L");o[o.length-1]="Z"}return o.length?(s.setAttribute("d",o.join("")),s):void 0},MultiPolygon:function(e,n){for(var i,r,a,s,o,l,u=t.svg("path"),h=[],c=e.coordinates,d=-1,f=c.length;++d<f;)for(i=c[d],a=-1,o=i.length;++a<o;){for(r=i[a],s=-1,l=r.length-1,h.push("M");++s<l;)h.push((p=n(r[s])).x,",",p.y,"L");h[h.length-1]="Z"}return h.length?(u.setAttribute("d",h.join("")),u):void 0},GeometryCollection:function(e,n){for(var r,a=t.svg("g"),s=-1,o=e.geometries,l=o.length;++s<l;)(r=i(o[s],n))&&a.appendChild(r);return a}},b={Point:function(t,e,n){t=t.coordinates,e.setAttribute("transform","translate("+t.x+","+t.y+")"+n)},MultiPoint:function(t,e,n){t=t.coordinates;var i=-1,r=a.length;e=e.firstChild;for(var a;++i<r;)a=t[i],e.setAttribute("transform","translate("+a.x+","+a.y+")"+n),e=e.nextSibling}};l.url=function(e){return arguments.length?(s="string"==typeof e&&/{.}/.test(e)?t.url(e):e,null!=s&&(o=null),"string"==typeof s&&l.tile(!1),l.reload()):s},l.features=function(t){return arguments.length?((o=t)&&(s=null,l.tile(!1)),l.reload()):o},l.clip=function(t){if(!arguments.length)return h;h&&u.removeChild(f),(h=t)&&u.insertBefore(f,u.firstChild);var e=l.cache.locks();for(var n in e)h?e[n].element.setAttribute("clip-path",d):e[n].element.removeAttribute("clip-path");return l};var y=l.tile;l.tile=function(t){return arguments.length&&!t&&l.clip(t),y.apply(l,arguments)};var w=l.map;return l.map=function(t){if(t&&g){var e=t.tileSize();g.setAttribute("width",e.x),g.setAttribute("height",e.y)}return w.apply(l,arguments)},l.scale=function(t){return arguments.length?((m=t)?l.on("move",a):l.off("move",a),l.map()&&a(),l):m},l.show=function(t){return h?t.element.setAttribute("clip-path",d):t.element.removeAttribute("clip-path"),l.dispatch({type:"show",tile:t,features:t.features}),l},l.reshow=function(){var t=l.cache.locks();for(var e in t)l.show(t[e]);return l},l},t.dblclick=function(){function t(t){var n=e.zoom();n=t.shiftKey?Math.ceil(n)-n-1:1-n+Math.floor(n),"mouse"===r?e.zoomBy(n,e.mouse(t)):e.zoomBy(n)}var e,n,i={},r="mouse";return i.zoom=function(t){return arguments.length?(r=t,i):r},i.map=function(r){return arguments.length?(e&&(n.removeEventListener("dblclick",t,!1),n=null),(e=r)&&(n=e.container(),n.addEventListener("dblclick",t,!1)),i):e},i},t.drag=function(){function t(t){t.shiftKey||(r={x:t.clientX,y:t.clientY},n.focusableParent().focus(),t.preventDefault(),document.body.style.setProperty("cursor","move",null))}function e(t){r&&(n.panBy({x:t.clientX-r.x,y:t.clientY-r.y}),r.x=t.clientX,r.y=t.clientY)}var n,i,r,a={};return a.map=function(e){return arguments.length?(n&&(i.removeEventListener("mousedown",t,!1),i=null),(n=e)&&(i=n.container(),i.addEventListener("mousedown",t,!1)),a):n},window.addEventListener("mousemove",e,!1),window.addEventListener("mouseup",function(t){r&&(e(t),r=null,document.body.style.removeProperty("cursor"))},!1),a},t.wheel=function(){function t(){n=null}function e(e){var r,a=e.wheelDelta||-e.detail;if(a)if(o){try{h.scrollTop=1e3,h.dispatchEvent(e),a=1e3-h.scrollTop}catch(u){}a*=.005}else r=Date.now(),r-s>200?(a=a>0?1:-1,s=r):a=0;if(a)switch(l){case"mouse":r=i.mouse(e),n||(n=i.pointLocation(r)),i.off("move",t).zoomBy(a,r,n).on("move",t);break;case"location":i.zoomBy(a,i.locationPoint(n),n);break;default:i.zoomBy(a)}return e.preventDefault(),!1}var n,i,r,a={},s=0,o=!0,l="mouse",u=document.createElement("div"),h=document.createElement("div");return h.style.visibility="hidden",h.style.top="0px",h.style.height="0px",h.style.width="0px",h.style.overflowY="scroll",u.style.height="2000px",h.appendChild(u),document.body.appendChild(h),a.smooth=function(t){return arguments.length?(o=t,a):o},a.zoom=function(e,r){return arguments.length?(l=e,n=r,i&&("mouse"==l?i.on("move",t):i.off("move",t)),a):l},a.map=function(n){return arguments.length?(i&&(r.removeEventListener("mousemove",t,!1),r.removeEventListener("mousewheel",e,!1),r.removeEventListener("MozMousePixelScroll",e,!1),r=null,i.off("move",t)),(i=n)&&("mouse"==l&&i.on("move",t),r=i.container(),r.addEventListener("mousemove",t,!1),r.addEventListener("mousewheel",e,!1),r.addEventListener("MozMousePixelScroll",e,!1)),a):i},a},t.arrow=function(){function t(t){if(!(t.ctrlKey||t.altKey||t.metaKey)){var e=Date.now(),n=0,s=0;switch(t.keyCode){case 37:l.left||(u=e,l.left=1,l.right||(n=d));break;case 39:l.right||(u=e,l.right=1,l.left||(n=-d));break;case 38:l.up||(u=e,l.up=1,l.down||(s=d));break;case 40:l.down||(u=e,l.down=1,l.up||(s=-d));break;default:return}(n||s)&&a.panBy({x:n,y:s}),!r&&l.left|l.right|l.up|l.down&&(r=setInterval(i,c)),t.preventDefault()}}function e(t){switch(u=Date.now(),t.keyCode){case 37:l.left=0;break;case 39:l.right=0;break;case 38:l.up=0;break;case 40:l.down=0;break;default:return}!r||l.left|l.right|l.up|l.down||(r=clearInterval(r)),t.preventDefault()}function n(t){switch(t.charCode){case 45:case 95:a.zoom(Math.ceil(a.zoom())-1);break;case 43:case 61:a.zoom(Math.floor(a.zoom())+1);break;default:return}t.preventDefault()}function i(){if(a&&!(Date.now()<u+h)){var t=(l.left-l.right)*d,e=(l.up-l.down)*d;(t||e)&&a.panBy({x:t,y:e})}}var r,a,s,o={},l={left:0,right:0,up:0,down:0},u=0,h=250,c=50,d=16;return o.map=function(i){return arguments.length?(a&&(s.removeEventListener("keypress",n,!1),s.removeEventListener("keydown",t,!1),s.removeEventListener("keyup",e,!1),s=null),(a=i)&&(s=a.focusableParent(),s.addEventListener("keypress",n,!1),s.addEventListener("keydown",t,!1),s.addEventListener("keyup",e,!1)),o):a},o.speed=function(t){return arguments.length?(d=t,o):d},o},t.hash=function(){function t(){var t=s(i);n!==t&&location.replace(n=t)}function e(){location.hash!==n&&a(i,(n=location.hash).substring(1))&&t()}var n,i,r={},a=function(t,e){var n=e.split("/").map(Number);if(n.length<3||n.some(isNaN))return!0;var i=t.size();t.zoomBy(n[0]-t.zoom(),{x:i.x/2,y:i.y/2},{lat:Math.min(89.99999999,Math.max(-89.99999999,n[1])),lon:n[2]})},s=function(t){var e=t.center();t=t.zoom();var n=Math.max(0,Math.ceil(Math.log(t)/Math.LN2));return"#"+t.toFixed(2)+"/"+e.lat.toFixed(n)+"/"+e.lon.toFixed(n)};return r.map=function(n){return arguments.length?(i&&(i.off("move",t),window.removeEventListener("hashchange",e,!1)),(i=n)&&(i.on("move",t),window.addEventListener("hashchange",e,!1),location.hash?e():t()),r):i},r.parser=function(t){return arguments.length?(a=t,r):a},r.formatter=function(t){return arguments.length?(s=t,r):s},r},t.touch=function(){function e(t){var e=-1,i=t.touches.length,s=Date.now();if(1==i&&300>s-l){var o=n.zoom();n.zoomBy(1-o+Math.floor(o),n.mouse(t.touches[0])),t.preventDefault()}for(l=s,r=n.zoom(),a=n.angle();++e<i;)s=t.touches[e],u[s.identifier]=n.pointLocation(n.mouse(s))}var n,i,r,a,s={},o=!1,l=0,u={};return window.addEventListener("touchmove",function(e){switch(e.touches.length){case 1:var i=e.touches[0];n.zoomBy(0,n.mouse(i),u[i.identifier]),e.preventDefault();break;case 2:i=e.touches[0];var s=e.touches[1],l=n.mouse(i),h=n.mouse(s);l={x:(l.x+h.x)/2,y:(l.y+h.y)/2},i=t.map.locationCoordinate(u[i.identifier]),s=t.map.locationCoordinate(u[s.identifier]),s=t.map.coordinateLocation({row:(i.row+s.row)/2,column:(i.column+s.column)/2,zoom:0}),n.zoomBy(Math.log(e.scale)/Math.LN2+r-n.zoom(),l,s),o&&n.angle(e.rotation/180*Math.PI+a),e.preventDefault()}},!1),s.rotate=function(t){return arguments.length?(o=t,s):o},s.map=function(t){return arguments.length?(n&&(i.removeEventListener("touchstart",e,!1),i=null),(n=t)&&(i=n.container(),i.addEventListener("touchstart",e,!1)),s):n},s},t.interact=function(){var e={},n=t.drag(),i=t.wheel(),r=t.dblclick(),a=t.touch(),s=t.arrow();return e.map=function(t){return n.map(t),i.map(t),r.map(t),a.map(t),s.map(t),e},e},t.compass=function(){function e(t){return T.setAttribute("class","compass active"),b||(b=setInterval(n,E)),y&&_.panBy(y),A=Date.now(),c(t)}function n(){y&&Date.now()>A+P&&_.panBy(y)}function i(t){return t.shiftKey?(x={x0:_.mouse(t)},_.focusableParent().focus(),c(t)):void 0}function r(t){x&&(x.x1=_.mouse(t),F.setAttribute("x",Math.min(x.x0.x,x.x1.x)),F.setAttribute("y",Math.min(x.x0.y,x.x1.y)),F.setAttribute("width",Math.abs(x.x0.x-x.x1.x)),F.setAttribute("height",Math.abs(x.x0.y-x.x1.y)),F.removeAttribute("display"))}function a(){T.setAttribute("class","compass"),x&&(x.x1&&(_.extent([_.pointLocation({x:Math.min(x.x0.x,x.x1.x),y:Math.max(x.x0.y,x.x1.y)}),_.pointLocation({x:Math.max(x.x0.x,x.x1.x),y:Math.min(x.x0.y,x.x1.y)})]),F.setAttribute("display","none")),x=null),b&&(clearInterval(b),b=0)}function s(t){return function(){t?this.setAttribute("class","active"):this.removeAttribute("class"),y=t}}function o(t){return function(e){T.setAttribute("class","compass active");var n=_.zoom();return _.zoom(0>t?Math.ceil(n)-1:Math.floor(n)+1),c(e)}}function l(t){return function(e){return _.zoom(t),c(e)}}function u(){this.setAttribute("class","active")}function h(){this.removeAttribute("class")}function c(t){return t.stopPropagation(),t.preventDefault(),!1}function d(n){var i=Math.SQRT1_2*M,r=.7*M,a=.2*M,o=t.svg("g"),l=o.appendChild(t.svg("path")),u=o.appendChild(t.svg("path"));return l.setAttribute("class","direction"),l.setAttribute("pointer-events","all"),l.setAttribute("d","M0,0L"+i+","+i+"A"+M+","+M+" 0 0,1 "+-i+","+i+"Z"),u.setAttribute("class","chevron"),u.setAttribute("d","M"+a+","+(r-a)+"L0,"+r+" "+-a+","+(r-a)),u.setAttribute("pointer-events","none"),o.addEventListener("mousedown",e,!1),o.addEventListener("mouseover",s(n),!1),o.addEventListener("mouseout",s(null),!1),o.addEventListener("dblclick",c,!1),o}function f(e){var n=.4*M,i=n/2,r=t.svg("g"),a=r.appendChild(t.svg("path")),s=r.appendChild(t.svg("path")),l=r.appendChild(t.svg("path")),d=r.appendChild(t.svg("path"));return a.setAttribute("class","back"),a.setAttribute("d","M"+-n+",0V"+-n+"A"+n+","+n+" 0 1,1 "+n+","+-n+"V0Z"),s.setAttribute("class","direction"),s.setAttribute("d",a.getAttribute("d")),l.setAttribute("class","chevron"),l.setAttribute("d","M"+-i+","+-n+"H"+i+(e>0?"M0,"+(-n-i)+"V"+-i:"")),d.setAttribute("class","fore"),d.setAttribute("fill","none"),d.setAttribute("d",a.getAttribute("d")),r.addEventListener("mousedown",o(e),!1),r.addEventListener("mouseover",u,!1),r.addEventListener("mouseout",h,!1),r.addEventListener("dblclick",c,!1),r}function p(e){var n=.2*M,i=.4*M,r=t.svg("g"),a=r.appendChild(t.svg("rect")),s=r.appendChild(t.svg("path"));return a.setAttribute("pointer-events","all"),a.setAttribute("fill","none"),a.setAttribute("x",-i),a.setAttribute("y",-.75*i),a.setAttribute("width",2*i),a.setAttribute("height",1.5*i),s.setAttribute("class","chevron"),s.setAttribute("d","M"+-n+",0H"+n),r.addEventListener("mousedown",l(e),!1),r.addEventListener("dblclick",c,!1),r}function g(){var t=M+6,e=t,n=_.size();switch(R){case"top-left":break;case"top-right":t=n.x-t;break;case"bottom-left":e=n.y-e;break;case"bottom-right":t=n.x-t,e=n.y-e}T.setAttribute("transform","translate("+t+","+e+")"),F.setAttribute("transform","translate("+-t+","+-e+")");for(var i in D)i==_.zoom()?D[i].setAttribute("class","active"):D[i].removeAttribute("class")}function m(){for(;T.lastChild;)T.removeChild(T.lastChild);if(T.appendChild(F),"none"!=N){w=T.appendChild(t.svg("g")),w.setAttribute("class","pan");var e=w.appendChild(t.svg("circle"));e.setAttribute("class","back"),e.setAttribute("r",M),w.appendChild(d({x:0,y:-I})).setAttribute("transform","rotate(0)"),w.appendChild(d({x:I,y:0})).setAttribute("transform","rotate(90)"),w.appendChild(d({x:0,y:I})).setAttribute("transform","rotate(180)"),w.appendChild(d({x:-I,y:0})).setAttribute("transform","rotate(270)"),e=w.appendChild(t.svg("circle")),e.setAttribute("fill","none"),e.setAttribute("class","fore"),e.setAttribute("r",M)}else w=null;if("none"!=L){if(v=T.appendChild(t.svg("g")),v.setAttribute("class","zoom"),e=-.5,"big"==L){D={};var n=_.zoomRange()[0];for(e=0;n<=_.zoomRange()[1];n++,e++)(D[n]=v.appendChild(p(n))).setAttribute("transform","translate(0,"+-(e+.75)*M*.4+")")}n="none"==N?.4:2,v.setAttribute("transform","translate(0,"+M*(/^top-/.test(R)?n+.4*(e+.5):-n)+")"),v.appendChild(f(1)).setAttribute("transform","translate(0,"+-(e+.5)*M*.4+")"),v.appendChild(f(-1)).setAttribute("transform","scale(-1)")}else v=null;g()}var v,b,y,w,x,_,C,k,S={},T=t.svg("g"),D={},M=30,I=16,A=0,P=250,E=50,R="top-left",L="small",N="small",F=t.svg("rect");return T.setAttribute("class","compass"),F.setAttribute("class","back fore"),F.setAttribute("pointer-events","none"),F.setAttribute("display","none"),S.radius=function(t){return arguments.length?(M=t,_&&m(),S):M},S.speed=function(t){return arguments.length?(I=t,S):M},S.position=function(t){return arguments.length?(R=t,_&&m(),S):R},S.pan=function(t){return arguments.length?(N=t,_&&m(),S):N},S.zoom=function(t){return arguments.length?(L=t,_&&m(),S):L},S.map=function(t){return arguments.length?(_&&(C.removeEventListener("mousedown",i,!1),C.removeChild(T),C=null,k.removeEventListener("mousemove",r,!1),k.removeEventListener("mouseup",a,!1),k=null,_.off("move",g).off("resize",g)),(_=t)&&(C=_.container(),C.appendChild(T),C.addEventListener("mousedown",i,!1),k=C.ownerDocument.defaultView,k.addEventListener("mousemove",r,!1),k.addEventListener("mouseup",a,!1),_.on("move",g).on("resize",g),m()),S):_},S},t.grid=function(){function e(){var e=r.firstChild,i=n.size(),a=n.pointLocation(l);n.pointLocation(i);var s=Math.pow(2,4-Math.round(n.zoom()));a.lat=Math.floor(a.lat/s)*s,a.lon=Math.ceil(a.lon/s)*s;for(var o;(o=n.locationPoint(a).x)<=i.x;a.lon+=s)e||(e=r.appendChild(t.svg("line"))),e.setAttribute("x1",o),e.setAttribute("x2",o),e.setAttribute("y1",0),e.setAttribute("y2",i.y),e=e.nextSibling;for(;(o=n.locationPoint(a).y)<=i.y;a.lat-=s)e||(e=r.appendChild(t.svg("line"))),e.setAttribute("y1",o),e.setAttribute("y2",o),e.setAttribute("x1",0),e.setAttribute("x2",i.x),e=e.nextSibling;for(;e;)i=e.nextSibling,r.removeChild(e),e=i}var n,i={},r=t.svg("g");return r.setAttribute("class","grid"),i.map=function(t){return arguments.length?(n&&(r.parentNode.removeChild(r),n.off("move",e).off("resize",e)),(n=t)&&(n.on("move",e).on("resize",e),n.container().appendChild(r),n.dispatch({type:"move"})),i):n},i},t.stylist=function(){function n(e){var n,s,o,l,u,h,c=e.features.length,d=r.length,f=a.length;for(u=0;c>u;++u)if(s=(n=e.features[u]).element){for(n=n.data,h=0;d>h;++h)l=(o=r[h]).value,"function"==typeof l&&(l=l.call(null,n)),null==l?o.name.local?s.removeAttributeNS(o.name.space,o.name.local):s.removeAttribute(o.name):o.name.local?s.setAttributeNS(o.name.space,o.name.local,l):s.setAttribute(o.name,l);for(h=0;f>h;++h)l=(o=a[h]).value,"function"==typeof l&&(l=l.call(null,n)),null==l?s.style.removeProperty(o.name):s.style.setProperty(o.name,l,o.priority);if(l=i){for("function"==typeof l&&(l=l.call(null,n));s.lastChild;)s.removeChild(s.lastChild);null!=l&&s.appendChild(t.svg("title")).appendChild(document.createTextNode(l))}}}var i,r=[],a=[];return n.attr=function(t,i){return r.push({name:e(t),value:i}),n},n.style=function(t,e,i){return a.push({name:t,value:e,priority:arguments.length<3?null:i}),n},n.title=function(t){return i=t,n},n}}(org.polymaps);