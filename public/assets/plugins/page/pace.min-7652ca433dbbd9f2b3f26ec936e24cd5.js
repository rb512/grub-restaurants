(function(){var t,e,n,i,r,a,s,o,l,h,u,c,d,f,p,g,m,v,b,y,w,x,_,C,k,S,T,D,M,I,A,P,E,R,F,N,L,H,j,O,B=[].slice,z={}.hasOwnProperty,$=function(t,e){function n(){this.constructor=t}for(var i in e)z.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},W=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};b={catchupTime:500,initialRate:.03,minTime:500,ghostTime:250,maxProgressPerFrame:10,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET"],trackWebSockets:!1}},S=function(){var t;return null!=(t="undefined"!=typeof performance&&null!==performance?"function"==typeof performance.now?performance.now():void 0:void 0)?t:+new Date},D=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,v=window.cancelAnimationFrame||window.mozCancelAnimationFrame,null==D&&(D=function(t){return setTimeout(t,50)},v=function(t){return clearTimeout(t)}),I=function(t){var e,n;return e=S(),(n=function(){var i;return i=S()-e,e=S(),t(i,function(){return D(n)})})()},M=function(){var t,e,n;return n=arguments[0],e=arguments[1],t=3<=arguments.length?B.call(arguments,2):[],"function"==typeof n[e]?n[e].apply(n,t):n[e]},y=function(){var t,e,n,i,r,a,s;for(e=arguments[0],i=2<=arguments.length?B.call(arguments,1):[],a=0,s=i.length;s>a;a++)if(n=i[a])for(t in n)z.call(n,t)&&(r=n[t],null!=e[t]&&"object"==typeof e[t]&&null!=r&&"object"==typeof r?y(e[t],r):e[t]=r);return e},p=function(t){var e,n,i,r,a;for(n=e=0,r=0,a=t.length;a>r;r++)i=t[r],n+=Math.abs(i),e++;return n/e},x=function(t,e){var n,i,r;if(null==t&&(t="options"),null==e&&(e=!0),r=document.querySelector("[data-pace-"+t+"]")){if(n=r.getAttribute("data-pace-"+t),!e)return n;try{return JSON.parse(n)}catch(a){return i=a,"undefined"!=typeof console&&null!==console?console.error("Error parsing inline pace options",i):void 0}}},null==window.Pace&&(window.Pace={}),T=Pace.options=y(b,window.paceOptions,x()),o=function(t){function e(){return j=e.__super__.constructor.apply(this,arguments)}return $(e,t),e}(Error),e=function(){function t(){this.progress=0}return t.prototype.getElement=function(){var t;if(null==this.el){if(t=document.querySelector(T.target),!t)throw new o;this.el=document.createElement("div"),this.el.className="pace pace-active",document.body.className=document.body.className.replace("pace-done",""),document.body.className+=" pace-running",this.el.innerHTML='<div class="pace-progress">\n  <div class="pace-progress-inner"></div>\n</div>\n<div class="pace-activity"></div>',null!=t.firstChild?t.insertBefore(this.el,t.firstChild):t.appendChild(this.el)}return this.el},t.prototype.finish=function(){var t;return t=this.getElement(),t.className=t.className.replace("pace-active",""),t.className+=" pace-inactive",document.body.className=document.body.className.replace("pace-running",""),document.body.className+=" pace-done"},t.prototype.update=function(t){return this.progress=t,this.render()},t.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(t){o=t}return this.el=void 0},t.prototype.render=function(){var t,e;return null==document.querySelector(T.target)?!1:(t=this.getElement(),t.children[0].style.width=""+this.progress+"%",(!this.lastRenderedProgress||0|(this.lastRenderedProgress|0!==this.progress))&&(t.children[0].setAttribute("data-progress-text",""+(0|this.progress)+"%"),this.progress>=100?e="99":(e=this.progress<10?"0":"",e+=0|this.progress),t.children[0].setAttribute("data-progress",""+e)),this.lastRenderedProgress=this.progress)},t.prototype.done=function(){return this.progress>=100},t}(),s=function(){function t(){this.bindings={}}return t.prototype.trigger=function(t,e){var n,i,r,a,s;if(null!=this.bindings[t]){for(a=this.bindings[t],s=[],i=0,r=a.length;r>i;i++)n=a[i],s.push(n.call(this,e));return s}},t.prototype.on=function(t,e){var n;return null==(n=this.bindings)[t]&&(n[t]=[]),this.bindings[t].push(e)},t}(),N=window.XMLHttpRequest,F=window.XDomainRequest,R=window.WebSocket,w=function(t,e){var n,i,r,a;a=[];for(i in e.prototype)try{r=e.prototype[i],null==t[i]&&"function"!=typeof r?a.push(t[i]=r):a.push(void 0)}catch(s){n=s}return a},l=function(t){function e(){var t,n=this;e.__super__.constructor.apply(this,arguments),t=function(t){var e;return e=t.open,t.open=function(i,r){var a;return a=(null!=i?i:"GET").toUpperCase(),W.call(T.ajax.trackMethods,a)>=0&&n.trigger("request",{type:i,url:r,request:t}),e.apply(t,arguments)}},window.XMLHttpRequest=function(e){var n;return n=new N(e),t(n),n},w(window.XMLHttpRequest,N),null!=F&&(window.XDomainRequest=function(){var e;return e=new F,t(e),e},w(window.XDomainRequest,F)),null!=R&&T.ajax.trackWebSockets&&(window.WebSocket=function(t,e){var i;return i=new R(t,e),n.trigger("request",{type:"socket",url:t,protocols:e,request:i}),i},w(window.WebSocket,R))}return $(e,t),e}(s),L=null,_=function(){return null==L&&(L=new l),L},T.restartOnRequestAfter!==!1&&_().on("request",function(e){var n,i,r;return r=e.type,i=e.request,Pace.running?void 0:(n=arguments,setTimeout(function(){var e,a,s,o,l,h,u;if(a="socket"===r?i.readyState<2:0<(l=i.readyState)&&4>l){for(Pace.restart(),h=Pace.sources,u=[],s=0,o=h.length;o>s;s++){if(e=h[s],e instanceof t){e.watch.apply(e,n);break}u.push(void 0)}return u}},T.restartOnRequestAfter))}),t=function(){function t(){var t=this;this.elements=[],_().on("request",function(){return t.watch.apply(t,arguments)})}return t.prototype.watch=function(t){var e,n,i;return i=t.type,e=t.request,n="socket"===i?new c(e):new d(e),this.elements.push(n)},t}(),d=function(){function t(t){var e,n,i,r,a,s,o=this;if(this.progress=0,null!=window.ProgressEvent)for(n=null,t.addEventListener("progress",function(t){return o.progress=t.lengthComputable?100*t.loaded/t.total:o.progress+(100-o.progress)/2}),s=["load","abort","timeout","error"],i=0,r=s.length;r>i;i++)e=s[i],t.addEventListener(e,function(){return o.progress=100});else a=t.onreadystatechange,t.onreadystatechange=function(){var e;return 0===(e=t.readyState)||4===e?o.progress=100:3===t.readyState&&(o.progress=50),"function"==typeof a?a.apply(null,arguments):void 0}}return t}(),c=function(){function t(t){var e,n,i,r,a=this;for(this.progress=0,r=["error","open"],n=0,i=r.length;i>n;n++)e=r[n],t.addEventListener(e,function(){return a.progress=100})}return t}(),i=function(){function t(t){var e,n,i,a;for(null==t&&(t={}),this.elements=[],null==t.selectors&&(t.selectors=[]),a=t.selectors,n=0,i=a.length;i>n;n++)e=a[n],this.elements.push(new r(e))}return t}(),r=function(){function t(t){this.selector=t,this.progress=0,this.check()}return t.prototype.check=function(){var t=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return t.check()},T.elements.checkInterval)},t.prototype.done=function(){return this.progress=100},t}(),n=function(){function t(){var t,e,n=this;this.progress=null!=(e=this.states[document.readyState])?e:100,t=document.onreadystatechange,document.onreadystatechange=function(){return null!=n.states[document.readyState]&&(n.progress=n.states[document.readyState]),"function"==typeof t?t.apply(null,arguments):void 0}}return t.prototype.states={loading:0,interactive:50,complete:100},t}(),a=function(){function t(){var t,e,n,i,r,a=this;this.progress=0,t=0,r=[],i=0,n=S(),e=setInterval(function(){var s;return s=S()-n-50,n=S(),r.push(s),r.length>T.eventLag.sampleCount&&r.shift(),t=p(r),++i>=T.eventLag.minSamples&&t<T.eventLag.lagThreshold?(a.progress=100,clearInterval(e)):a.progress=100*(3/(t+3))},50)}return t}(),u=function(){function t(t){this.source=t,this.last=this.sinceLastUpdate=0,this.rate=T.initialRate,this.catchup=0,this.progress=this.lastProgress=0,null!=this.source&&(this.progress=M(this.source,"progress"))}return t.prototype.tick=function(t,e){var n;return null==e&&(e=M(this.source,"progress")),e>=100&&(this.done=!0),e===this.last?this.sinceLastUpdate+=t:(this.sinceLastUpdate&&(this.rate=(e-this.last)/this.sinceLastUpdate),this.catchup=(e-this.progress)/T.catchupTime,this.sinceLastUpdate=0,this.last=e),e>this.progress&&(this.progress+=this.catchup*t),n=1-Math.pow(this.progress/100,T.easeFactor),this.progress+=n*this.rate*t,this.progress=Math.min(this.lastProgress+T.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},t}(),P=null,A=null,g=null,E=null,f=null,m=null,Pace.running=!1,C=function(){return T.restartOnPushState?Pace.restart():void 0},null!=window.history.pushState&&(H=window.history.pushState,window.history.pushState=function(){return C(),H.apply(window.history,arguments)}),null!=window.history.replaceState&&(O=window.history.replaceState,window.history.replaceState=function(){return C(),O.apply(window.history,arguments)}),h={ajax:t,elements:i,document:n,eventLag:a},(k=function(){var t,n,i,r,a,s,o,l,c;for(Pace.sources=P=[],o=["ajax","elements","document","eventLag"],i=0,a=o.length;a>i;i++)n=o[i],T[n]!==!1&&P.push(new h[n](T[n]));for(c=null!=(l=T.extraSources)?l:[],r=0,s=c.length;s>r;r++)t=c[r],P.push(new t(T));return Pace.bar=g=new e,A=[],E=new u})(),Pace.stop=function(){return Pace.running=!1,g.destroy(),m=!0,null!=f&&("function"==typeof v&&v(f),f=null),k()},Pace.restart=function(){return Pace.stop(),Pace.start()},Pace.go=function(){return Pace.running=!0,g.render(),m=!1,f=I(function(t,e){var n,i,r,a,s,o,l,h,c,d,f,p,v,b,y,w,x,_;for(h=100-g.progress,i=v=0,r=!0,o=b=0,w=P.length;w>b;o=++b)for(f=P[o],d=null!=A[o]?A[o]:A[o]=[],s=null!=(_=f.elements)?_:[f],l=y=0,x=s.length;x>y;l=++y)a=s[l],c=null!=d[l]?d[l]:d[l]=new u(a),r&=c.done,c.done||(i++,v+=c.tick(t));return n=v/i,g.update(E.tick(t,n)),p=S(),g.done()||r||m?(g.update(100),setTimeout(function(){return g.finish(),Pace.running=!1},Math.max(T.ghostTime,Math.min(T.minTime,S()-p)))):e()})},Pace.start=function(t){y(T,t),Pace.running=!0;try{g.render()}catch(e){o=e}return document.querySelector(".pace")?Pace.go():setTimeout(Pace.start,50)},"function"==typeof define&&define.amd?define(function(){return Pace}):"object"==typeof exports?module.exports=Pace:T.startOnPageLoad&&Pace.start()}).call(this);